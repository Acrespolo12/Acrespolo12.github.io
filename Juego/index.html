<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Juego √çntimo para Parejas</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #1a0a0f, #4a0e2a, #1a0a0f);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
            min-height: 100vh;
            color: #fff;
            overflow-x: hidden;
        }

        @keyframes gradientShift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 30px 20px;
            position: relative;
        }

        .screen {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .screen.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .header h1 {
            font-size: 3em;
            background: linear-gradient(135deg, #ff1744, #ff4081, #f50057);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 15px;
            letter-spacing: 3px;
            text-shadow: 0 0 30px rgba(255, 64, 129, 0.5);
        }

        .header p {
            color: rgba(255, 255, 255, 0.7);
            font-size: 1.1em;
            letter-spacing: 1px;
        }

        .config-section {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 25px;
            border: 1px solid rgba(255, 64, 129, 0.3);
            transition: all 0.3s ease;
        }

        .config-section:hover {
            border-color: rgba(255, 64, 129, 0.6);
            box-shadow: 0 10px 30px rgba(255, 64, 129, 0.2);
        }

        .config-section h2 {
            color: #ff4081;
            margin-bottom: 20px;
            font-size: 1.5em;
        }

        .checkbox-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            background: rgba(255, 64, 129, 0.1);
            padding: 12px 15px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .checkbox-item:hover {
            background: rgba(255, 64, 129, 0.2);
            border-color: rgba(255, 64, 129, 0.5);
            transform: translateX(5px);
        }

        .checkbox-item input[type="checkbox"] {
            width: 20px;
            height: 20px;
            margin-right: 10px;
            cursor: pointer;
            accent-color: #ff4081;
        }

        .checkbox-item.checked {
            background: rgba(255, 64, 129, 0.3);
            border-color: #ff4081;
        }

        .intensity-selector {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .intensity-btn {
            padding: 15px 30px;
            border: 2px solid rgba(255, 64, 129, 0.5);
            background: rgba(255, 64, 129, 0.1);
            color: #fff;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.1em;
            font-weight: 600;
        }

        .intensity-btn:hover {
            background: rgba(255, 64, 129, 0.2);
            transform: scale(1.05);
        }

        .intensity-btn.selected {
            background: linear-gradient(135deg, #ff4081, #f50057);
            border-color: #ff4081;
            box-shadow: 0 0 30px rgba(255, 64, 129, 0.6);
        }

        .btn-primary {
            display: block;
            width: 100%;
            max-width: 400px;
            margin: 30px auto 0;
            padding: 20px;
            background: linear-gradient(135deg, #ff4081, #f50057);
            border: none;
            border-radius: 15px;
            color: #fff;
            font-size: 1.3em;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .btn-primary:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 40px rgba(255, 64, 129, 0.6);
        }

        .game-modes {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .mode-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border: 2px solid rgba(255, 64, 129, 0.3);
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.4s ease;
            position: relative;
            overflow: hidden;
        }

        .mode-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 64, 129, 0.3), transparent);
            transition: left 0.5s;
        }

        .mode-card:hover::before {
            left: 100%;
        }

        .mode-card:hover {
            transform: translateY(-10px);
            border-color: #ff4081;
            box-shadow: 0 15px 40px rgba(255, 64, 129, 0.5);
        }

        .mode-icon {
            font-size: 4em;
            margin-bottom: 15px;
            filter: drop-shadow(0 0 10px rgba(255, 64, 129, 0.5));
        }

        .mode-card h3 {
            color: #ff4081;
            font-size: 1.5em;
            margin-bottom: 10px;
        }

        .mode-card p {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.95em;
        }

        .game-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 70vh;
        }

        .challenge-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(30px);
            border: 2px solid rgba(255, 64, 129, 0.4);
            border-radius: 25px;
            padding: 50px 40px;
            max-width: 700px;
            width: 100%;
            text-align: center;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            margin: 30px 0;
            animation: cardPulse 2s ease-in-out infinite;
        }

        @keyframes cardPulse {
            0%, 100% { box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5); }
            50% { box-shadow: 0 20px 60px rgba(255, 64, 129, 0.3); }
        }

        .category-badge {
            display: inline-block;
            padding: 8px 20px;
            background: linear-gradient(135deg, #ff4081, #f50057);
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: 600;
            letter-spacing: 1px;
            margin-bottom: 25px;
            text-transform: uppercase;
            box-shadow: 0 5px 15px rgba(255, 64, 129, 0.4);
        }

        .challenge-text {
            font-size: 1.8em;
            line-height: 1.6;
            margin: 30px 0;
            color: #fff;
            font-weight: 300;
        }

        .challenge-text strong {
            color: #ff4081;
            font-weight: 600;
        }

        .timer {
            font-size: 3em;
            color: #ff4081;
            margin: 20px 0;
            font-weight: 700;
            text-shadow: 0 0 20px rgba(255, 64, 129, 0.8);
        }

        .timer.warning {
            color: #ff1744;
            animation: timerBlink 1s infinite;
        }

        @keyframes timerBlink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .game-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 30px;
        }

        .btn-action {
            padding: 15px 30px;
            border: 2px solid rgba(255, 64, 129, 0.5);
            background: rgba(255, 64, 129, 0.15);
            color: #fff;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.1em;
            font-weight: 600;
        }

        .btn-action:hover {
            background: rgba(255, 64, 129, 0.3);
            transform: scale(1.05);
        }

        .btn-next {
            background: linear-gradient(135deg, #ff4081, #f50057);
            border-color: #ff4081;
        }

        .btn-next:hover {
            box-shadow: 0 0 30px rgba(255, 64, 129, 0.6);
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff4081, #f50057);
            border-radius: 10px;
            transition: width 0.5s ease;
            box-shadow: 0 0 10px rgba(255, 64, 129, 0.8);
        }

        .challenge-counter {
            text-align: center;
            color: rgba(255, 255, 255, 0.8);
            font-size: 1.1em;
            margin-bottom: 10px;
        }

        .back-btn, .home-btn {
            position: fixed;
            top: 20px;
            padding: 10px 20px;
            border-radius: 10px;
            color: #fff;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 100;
            border: none;
            font-size: 1em;
            font-weight: 600;
        }

        .back-btn {
            left: 20px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .back-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateX(-5px);
        }

        .home-btn {
            right: 20px;
            background: rgba(255, 64, 129, 0.2);
            border: 1px solid rgba(255, 64, 129, 0.5);
        }

        .home-btn:hover {
            background: rgba(255, 64, 129, 0.4);
            box-shadow: 0 0 20px rgba(255, 64, 129, 0.5);
            transform: translateX(5px);
        }

        .dice-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 30px 0;
        }

        .dice {
            width: 80px;
            height: 80px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3em;
            color: #1a0a0f;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            transition: all 0.3s ease;
        }

        .dice.rolling {
            animation: diceRoll 0.5s ease-in-out;
        }

        @keyframes diceRoll {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(90deg); }
            50% { transform: rotate(180deg); }
            75% { transform: rotate(270deg); }
        }

        .card-deck {
            perspective: 1000px;
            margin: 30px 0;
        }

        .card {
            width: 200px;
            height: 280px;
            margin: 0 auto;
            background: linear-gradient(135deg, #ff4081, #f50057);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 4em;
            cursor: pointer;
            transition: all 0.5s ease;
            transform-style: preserve-3d;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.5);
        }

        .card:hover {
            transform: translateY(-10px) rotateY(10deg);
        }

        .card.flipping {
            animation: cardFlip 0.6s ease-in-out;
        }

        @keyframes cardFlip {
            0% { transform: rotateY(0deg); }
            50% { transform: rotateY(90deg); }
            100% { transform: rotateY(0deg); }
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2em;
            }

            .checkbox-grid {
                grid-template-columns: 1fr;
            }

            .intensity-selector {
                flex-direction: column;
            }

            .challenge-text {
                font-size: 1.3em;
            }

            .game-actions {
                flex-direction: column;
                width: 100%;
            }

            .btn-action {
                width: 100%;
            }

            .back-btn, .home-btn {
                padding: 8px 15px;
                font-size: 0.9em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <button class="back-btn" onclick="goBack()" style="display: none;" id="backBtn">‚Üê Atr√°s</button>
        <button class="home-btn" onclick="goHome()" style="display: none;" id="homeBtn">üè† Inicio</button>

        <!-- PANTALLA 1: CONFIGURACI√ìN -->
        <div class="screen active" id="configScreen">
            <div class="header">
                <h1>üî• Juego √çntimo</h1>
                <p>Personaliza tu experiencia</p>
            </div>

            <div class="config-section">
                <h2>üìã Categor√≠as</h2>
                <div class="checkbox-grid" id="categoriesGrid"></div>
            </div>

            <div class="config-section">
                <h2>üéÅ Juguetes Disponibles</h2>
                <div class="checkbox-grid" id="toysGrid"></div>
            </div>

            <div class="config-section">
                <h2>üî• Nivel de Intensidad</h2>
                <div class="intensity-selector">
                    <button class="intensity-btn" data-level="suave">üå∏ Suave</button>
                    <button class="intensity-btn selected" data-level="medio">üî• Medio</button>
                    <button class="intensity-btn" data-level="intenso">üí• Intenso</button>
                </div>
            </div>

            <button class="btn-primary" onclick="goToModeSelection()">Continuar ‚Üí</button>
        </div>

        <!-- PANTALLA 2: SELECCI√ìN DE MODO -->
        <div class="screen" id="modeScreen">
            <div class="header">
                <h1>üéÆ Elige tu Modo</h1>
                <p>¬øC√≥mo quieres jugar?</p>
            </div>

            <div class="game-modes">
                <div class="mode-card" onclick="startGame('ruleta')">
                    <div class="mode-icon">üé°</div>
                    <h3>Ruleta del Placer</h3>
                    <p>Desaf√≠os completamente aleatorios</p>
                </div>

                <div class="mode-card" onclick="startGame('progresivo')">
                    <div class="mode-icon">üìà</div>
                    <h3>Modo Progresivo</h3>
                    <p>Comienza suave y va subiendo</p>
                </div>

                <div class="mode-card" onclick="startGame('dados')">
                    <div class="mode-icon">üé≤</div>
                    <h3>Dados Salvajes</h3>
                    <p>Tira y descubre tu reto</p>
                </div>

                <div class="mode-card" onclick="startGame('cartas')">
                    <div class="mode-icon">üÉè</div>
                    <h3>Cartas Sorpresa</h3>
                    <p>Saca una carta del mazo</p>
                </div>
            </div>
        </div>

        <!-- PANTALLA 3: JUEGO -->
        <div class="screen" id="gameScreen">
            <div class="game-container">
                <div class="challenge-counter" id="challengeCounter">Desaf√≠o 0 de 20</div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressBar" style="width: 0%"></div>
                </div>

                <!-- Dados (modo dados) -->
                <div class="dice-container" id="diceContainer" style="display: none;">
                    <div class="dice" id="dice1">üé≤</div>
                    <div class="dice" id="dice2">üé≤</div>
                </div>

                <!-- Carta (modo cartas) -->
                <div class="card-deck" id="cardDeck" style="display: none;">
                    <div class="card" id="card" onclick="drawCard()">üÉè</div>
                </div>

                <div class="challenge-card">
                    <div class="category-badge" id="categoryBadge">CATEGOR√çA</div>
                    <div class="challenge-text" id="challengeText">
                        Haz clic en "Siguiente" para comenzar
                    </div>
                    <div class="timer" id="timer" style="display: none;">5:00</div>
                </div>

                <div class="game-actions">
                    <button class="btn-action" onclick="skipChallenge()">‚è≠Ô∏è Saltar</button>
                    <button class="btn-action" onclick="startTimer()" id="timerBtn" style="display: none;">‚è±Ô∏è Iniciar Timer</button>
                    <button class="btn-action btn-next" onclick="nextChallenge()" id="nextBtn">Siguiente ‚Üí</button>
                    <button class="btn-action" onclick="endGame()">üèÅ Terminar</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const categories = [
            'BDSM', 'Tradicional', 'Fantas√≠as Bisexuales', 
            'Kamasutra', 'Preliminares', 'Castidad y Provocaci√≥n'
        ];

        const toys = [
            'Strapon', 'Dildo', 'Correas', 'Esposas', 'Plug Anal',
            'Vibradores', 'Consoladores', 'Lubricantes', 'Corrida Falsa',
            'Vendas', 'L√°tigo', 'Pinzas', 'Bolas Chinas'
        ];

        const challenges = {
            'BDSM': {
                suave: [
                    'El dominante ata las mu√±ecas del sumiso con {toy:correas} durante 3 minutos',
                    'Venda los ojos de tu pareja con {toy:vendas} y acaricia su cuerpo',
                    'El sumiso debe obedecer 2 √≥rdenes simples del dominante',
                    'Nalgadas suaves: 5 con la mano',
                    'Usa {toy:vendas} y alimenta a tu pareja con algo dulce'
                ],
                medio: [
                    'El dominante ata las mu√±ecas del sumiso con {toy:correas} durante 5 minutos',
                    'Usa {toy:pinzas} en los pezones de tu pareja durante 2 minutos',
                    'El dominante dicta una posici√≥n y el sumiso debe mantenerla por 3 minutos',
                    'Nalgadas: 10 con la mano, aumentando intensidad progresivamente',
                    'Ata a tu pareja a la cama con {toy:esposas} y hazle lo que quieras por 5 minutos',
                    'El sumiso debe gatear hasta el dominante y pedir permiso para tocar',
                    'Usa {toy:l√°tigo} suavemente en las nalgas y muslos de tu pareja',
                    'Coloca un {toy:plug anal} a tu pareja y contin√∫a con otras actividades'
                ],
                intenso: [
                    'El sumiso debe llamar "amo/ama" al dominante durante toda la siguiente actividad',
                    'Castigo: 20 nalgadas contadas en voz alta por el sumiso',
                    'Ata las cuatro extremidades y usa {toy:l√°tigo} durante 5 minutos',
                    'El dominante decide TODO por 10 minutos: posiciones, ritmo, intensidad',
                    'Usa {toy:pinzas} y {toy:l√°tigo} simult√°neamente',
                    'Dominaci√≥n completa: collar, correa y √≥rdenes por 15 minutos',
                    'Castigo extremo: 30 nalgadas con {toy:l√°tigo}',
                    'Asfixia er√≥tica controlada (con se√±al de seguridad)',
                    'Humillaci√≥n verbal mientras est√° atado/a'
                ]
            },
            'Tradicional': {
                suave: [
                    'Besos apasionados durante 3 minutos sin tocar otras partes',
                    'Masaje sensual en la espalda durante 5 minutos',
                    'Acaricia todo el cuerpo de tu pareja lentamente',
                    'Posici√≥n del misionero suave con contacto visual',
                    'Sexo oral gentil durante 3 minutos'
                ],
                medio: [
                    'Posici√≥n del misionero durante 5 minutos con contacto visual constante',
                    'Sexo oral: conc√©ntrate en dar placer a tu pareja durante 5 minutos',
                    'Penetraci√≥n en posici√≥n de cucharita con caricias suaves',
                    'Masturbaci√≥n mutua hasta que uno llegue al orgasmo',
                    'Posici√≥n de perrito con dominio y control del ritmo',
                    'Ella sobre √©l: deja que ella controle completamente el ritmo y profundidad',
                    '69: placer oral mutuo simult√°neo durante 5 minutos',
                    'Penetraci√≥n lenta y profunda mientras te besas apasionadamente'
                ],
                intenso: [
                    'Usa {toy:lubricantes} y explora diferentes velocidades de penetraci√≥n',
                    'Sexo contra la pared: intensidad y pasi√≥n sin control',
                    'Penetraci√≥n r√°pida e intensa en tu posici√≥n favorita',
                    'Sexo oral profundo hasta el orgasmo',
                    'Cambia de posici√≥n cada 2 minutos durante 10 minutos',
                    'Penetraci√≥n dura en perrito con nalgadas',
                    'Ella encima cabalgando lo m√°s r√°pido posible',
                    'Sexo intenso hasta que ambos lleguen al orgasmo'
                ]
            },
            'Fantas√≠as Bisexuales': {
                suave: [
                    'Comparte tu curiosidad sobre personas del mismo sexo',
                    'Describe c√≥mo besar√≠as a alguien del mismo sexo',
                    'Usa {toy:dildo} mientras hablas de fantas√≠as bisexuales',
                    'Imagina un encuentro suave con alguien del mismo sexo'
                ],
                medio: [
                    'Imagina un tr√≠o: describe qu√© har√≠as con una tercera persona del mismo sexo',
                    'Usa {toy:strapon} para invertir roles - √©l recibe, ella penetra',
                    'Juego de roles: act√∫en como dos desconocidos del mismo sexo que se conocen',
                    'Comparte tu fantas√≠a bisexual m√°s secreta con tu pareja',
                    'Usa {toy:dildo} mientras describes una escena con otra persona del mismo sexo',
                    'Ella practica sexo oral en {toy:dildo} como si fuera otra mujer',
                    '√âl practica sexo oral en {toy:dildo} imaginando que es otro hombre',
                    'Pegging: ella penetra a √©l con {toy:strapon} en posici√≥n suave'
                ],
                intenso: [
                    'Describe en detalle c√≥mo ser√≠a estar con alguien del mismo sexo mientras te masturbas',
                    'Usa {toy:corrida falsa} en un juego de roles bisexual intenso',
                    'Imaginen un tr√≠o bisexual: cada uno cuenta qu√© har√≠a con la tercera persona',
                    'Ella usa {toy:strapon} y √©l debe hacer sexo oral profundo antes de ser penetrado',
                    'Juego de sumisi√≥n: √©l recibe {toy:plug anal} mientras hace oral a {toy:dildo}',
                    'Escenario: est√°n en una org√≠a - describe en detalle qu√© har√≠as con personas del mismo sexo',
                    'Ella penetra a √©l con {toy:strapon} de forma intensa mientras √©l se masturba',
                    'Doble penetraci√≥n simulada: {toy:strapon} y {toy:dildo} simult√°neamente',
                    'Pegging duro con cambios de posici√≥n'
                ]
            },
            'Kamasutra': {
                suave: [
                    'Posici√≥n del Loto: si√©ntense frente a frente, piernas entrelazadas, movimientos lentos',
                    'El Columpio suave: ella sobre √©l, balance√°ndose con control',
                    'Abrazo del elefante: ambos de pie, abrazados, penetraci√≥n suave',
                    'La mariposa: ella recostada en el borde, √©l de pie, ritmo lento'
                ],
                medio: [
                    'Posici√≥n del Loto: si√©ntense frente a frente, piernas entrelazadas',
                    'La Carretilla: posici√≥n desafiante que requiere fuerza y balance',
                    'El Columpio: ella sobre √©l, balance√°ndose con control total',
                    'Posici√≥n de la Amazona: ella domina el ritmo completamente',
                    'La Mariposa: ella en el borde de la cama/mesa, √©l de pie penetrando',
                    'El Molino: ambos sentados, cara a cara, girando juntos',
                    'La Tigresa: ella a cuatro patas, √©l detr√°s con total control',
                    'La Serpiente: ambos de lado, √©l penetra desde atr√°s con piernas entrelazadas'
                ],
                intenso: [
                    'El Arco: posici√≥n acrob√°tica con penetraci√≥n profunda',
                    'El Cangrejo: posici√≥n invertida que requiere flexibilidad',
                    'La Diosa: ella sentada sobre √©l mirando hacia sus pies',
                    'El Puente: ella en puente, √©l penetra desde arriba',
                    'La Carretilla profunda con movimientos intensos',
                    'Posici√≥n del arado: penetraci√≥n m√°xima',
                    'Posiciones acrob√°ticas durante 10 minutos',
                    'Cambia entre 3 posiciones del Kamasutra cada 2 minutos'
                ]
            },
            'Preliminares': {
                suave: [
                    'Masaje suave en cuello y hombros durante 5 minutos',
                    'Besos tiernos por todo el rostro',
                    'Acaricia el cabello de tu pareja mientras la besas',
                    'Susurra cosas lindas al o√≠do',
                    'Masaje de pies con {toy:lubricantes}'
                ],
                medio: [
                    'Masaje sensual con {toy:lubricantes} durante 10 minutos',
                    'Besos por todo el cuerpo evitando zonas er√≥genas por 5 minutos',
                    'Susurra al o√≠do 3 cosas que quieres hacer esta noche',
                    'Desnuda a tu pareja muy lentamente, prenda por prenda',
                    'Usa solo la lengua para explorar el cuello y orejas de tu pareja',
                    'Usa {toy:vibradores} en zonas sensibles evitando genitales durante 5 minutos',
                    'Mordisquea suavemente los muslos internos de tu pareja',
                    'Masaje de pies y piernas subiendo lentamente con {toy:lubricantes}'
                ],
                intenso: [
                    'Succiona y lame los pezones de tu pareja durante 5 minutos',
                    'Usa cubitos de hielo para recorrer el cuerpo de tu pareja',
                    'Estimulaci√≥n del perineo con dedos y lengua',
                    'Masaje er√≥tico: explora todo el cuerpo con aceite durante 15 minutos',
                    'Besos franceses apasionados mientras acarician sus partes √≠ntimas',
                    'Ella se masturba mientras √©l observa sin tocar por 5 minutos',
                    '√âl se masturba mientras ella observa y da instrucciones',
                    'Oral intenso sin llegar al orgasmo',
                    'Estimulaci√≥n de todas las zonas er√≥genas simult√°neamente'
                ]
            },
            'Castidad y Provocaci√≥n': {
                suave: [
                    'Baila de forma sensual para tu pareja',
                    'T√≥cate suavemente frente a tu pareja por 2 minutos',
                    'Describe lo que quieres hacer sin tocarse',
                    'Besos provocativos sin contacto corporal',
                    'Striptease lento y sensual'
                ],
                medio: [
                    'T√≥cate frente a tu pareja pero ella/√©l no puede tocarte por 3 minutos',
                    'Baila de forma sensual haciendo un striptease completo',
                    'Provoca a tu pareja hasta que suplique pero no permitas contacto por 5 minutos',
                    'Masturbaci√≥n mutua sin llegar al orgasmo durante 10 minutos',
                    'Describe en detalle lo que quieres hacer pero sin tocar durante 3 minutos',
                    'Usa {toy:vibradores} en tu pareja pero detente justo antes del orgasmo - 3 veces',
                    'Sexo oral hasta casi el orgasmo, luego para completamente',
                    'Ella se penetra con {toy:dildo} mientras √©l solo puede mirar'
                ],
                intenso: [
                    '√âl se masturba con {toy:lubricantes} hasta el borde, sin terminar - 3 veces',
                    'Ata a tu pareja y prov√≥cala toc√°ndola en todas partes excepto genitales',
                    'Juego de negaci√≥n: penetraci√≥n por solo 10 segundos, luego para - repite 5 veces',
                    'Ella usa {toy:vibradores} en s√≠ misma mientras √©l est√° atado y observa',
                    '√âl debe aguantar sin correrse mientras ella hace lo que quiera por 10 minutos',
                    'Ruina su orgasmo: estimula hasta el cl√≠max pero detente justo en el momento',
                    'Control total: una persona decide cu√°ndo y c√≥mo puede correrse la otra',
                    'Orgasmo denegado: lleva al borde 5 veces sin dejar terminar',
                    'Castidad extrema: atado/a y provocado/a sin alivio por 15 minutos'
                ]
            }
        };

        let selectedCategories = [...categories];
        let selectedToys = [...toys];
        let intensity = 'medio';
        let currentMode = '';
        let challengeCount = 0;
        let usedChallenges = [];
        let timerInterval = null;
        let timerSeconds = 0;
        let progressiveLevel = 0;

        function initConfig() {
            const categoriesGrid = document.getElementById('categoriesGrid');
            const toysGrid = document.getElementById('toysGrid');

            loadConfig();

            categories.forEach(cat => {
                const item = createCheckboxItem(cat, selectedCategories.includes(cat));
                item.onclick = () => toggleSelection(cat, 'category', item);
                categoriesGrid.appendChild(item);
            });

            toys.forEach(toy => {
                const item = createCheckboxItem(toy, selectedToys.includes(toy));
                item.onclick = () => toggleSelection(toy, 'toy', item);
                toysGrid.appendChild(item);
            });

            document.querySelectorAll('.intensity-btn').forEach(btn => {
                btn.onclick = () => selectIntensity(btn);
                if (btn.dataset.level === intensity) {
                    btn.classList.add('selected');
                }
            });
        }

        function createCheckboxItem(text, checked) {
            const div = document.createElement('div');
            div.className = 'checkbox-item' + (checked ? ' checked' : '');
            div.innerHTML = `
                <input type="checkbox" ${checked ? 'checked' : ''}>
                <label>${text}</label>
            `;
            return div;
        }

        function toggleSelection(item, type, element) {
            const checkbox = element.querySelector('input');
            checkbox.checked = !checkbox.checked;
            element.classList.toggle('checked');

            if (type === 'category') {
                if (checkbox.checked) {
                    selectedCategories.push(item);
                } else {
                    selectedCategories = selectedCategories.filter(c => c !== item);
                }
            } else {
                if (checkbox.checked) {
                    selectedToys.push(item);
                } else {
                    selectedToys = selectedToys.filter(t => t !== item);
                }
            }
            saveConfig();
        }

        function selectIntensity(btn) {
            document.querySelectorAll('.intensity-btn').forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');
            intensity = btn.dataset.level;
            saveConfig();
        }

        function saveConfig() {
            const config = {
                categories: selectedCategories,
                toys: selectedToys,
                intensity: intensity
            };
            localStorage.setItem('intimateGameConfig', JSON.stringify(config));
        }

        function loadConfig() {
            const saved = localStorage.getItem('intimateGameConfig');
            if (saved) {
                const config = JSON.parse(saved);
                selectedCategories = config.categories || [...categories];
                selectedToys = config.toys || [...toys];
                intensity = config.intensity || 'medio';
            }
        }

        function goToModeSelection() {
            if (selectedCategories.length === 0) {
                alert('‚ö†Ô∏è Selecciona al menos una categor√≠a');
                return;
            }
            saveConfig();
            showScreen('modeScreen');
        }

        function startGame(mode) {
            currentMode = mode;
            challengeCount = 0;
            usedChallenges = [];
            progressiveLevel = 0;
            
            document.getElementById('diceContainer').style.display = 'none';
            document.getElementById('cardDeck').style.display = 'none';
            document.getElementById('timerBtn').style.display = 'none';
            
            if (mode === 'dados') {
                document.getElementById('diceContainer').style.display = 'flex';
            } else if (mode === 'cartas') {
                document.getElementById('cardDeck').style.display = 'block';
            }
            
            showScreen('gameScreen');
            updateCounter();
        }

        function nextChallenge() {
            if (currentMode === 'dados') {
                rollDice();
            } else if (currentMode === 'cartas') {
                alert('üÉè Haz clic en la carta para sacar un desaf√≠o');
            } else {
                generateChallenge();
            }
        }

        function generateChallenge() {
            challengeCount++;
            updateCounter();
            updateProgress();

            let level = intensity;
            
            if (currentMode === 'progresivo') {
                progressiveLevel = Math.floor(challengeCount / 7);
                if (progressiveLevel === 0) level = 'suave';
                else if (progressiveLevel === 1) level = 'medio';
                else level = 'intenso';
            }

            const randomCategory = selectedCategories[Math.floor(Math.random() * selectedCategories.length)];
            const categoryChalls = challenges[randomCategory][level];
            let challenge = categoryChalls[Math.floor(Math.random() * categoryChalls.length)];

            challenge = challenge.replace(/{toy:([^}]+)}/g, (match, toyType) => {
                const availableToys = selectedToys.filter(t => 
                    t.toLowerCase().includes(toyType.toLowerCase())
                );
                if (availableToys.length > 0) {
                    return `<strong>${availableToys[Math.floor(Math.random() * availableToys.length)]}</strong>`;
                }
                return '<strong>tus manos</strong>';
            });

            document.getElementById('categoryBadge').textContent = randomCategory;
            document.getElementById('challengeText').innerHTML = challenge;
            
            if (challenge.includes('minutos') || challenge.includes('durante')) {
                document.getElementById('timerBtn').style.display = 'inline-block';
            } else {
                document.getElementById('timerBtn').style.display = 'none';
            }

            stopTimer();

            if (challengeCount >= 20) {
                setTimeout(() => {
                    alert('üèÜ ¬°Felicidades! Han completado 20 desaf√≠os. ¬°Qu√© noche incre√≠ble!');
                    showScreen('modeScreen');
                }, 1000);
            }
        }

        function rollDice() {
            const dice1 = document.getElementById('dice1');
            const dice2 = document.getElementById('dice2');
            
            dice1.classList.add('rolling');
            dice2.classList.add('rolling');

            setTimeout(() => {
                const roll1 = Math.floor(Math.random() * 6) + 1;
                const roll2 = Math.floor(Math.random() * 6) + 1;
                
                dice1.textContent = roll1;
                dice2.textContent = roll2;
                
                dice1.classList.remove('rolling');
                dice2.classList.remove('rolling');
                
                generateChallenge();
            }, 500);
        }

        function drawCard() {
            const card = document.getElementById('card');
            card.classList.add('flipping');
            
            setTimeout(() => {
                card.classList.remove('flipping');
                generateChallenge();
            }, 600);
        }

        function startTimer() {
            const timerText = document.getElementById('challengeText').textContent;
            const match = timerText.match(/(\d+)\s*minutos?/);
            
            if (match) {
                timerSeconds = parseInt(match[1]) * 60;
            } else {
                timerSeconds = 300; // 5 minutos por defecto
            }
            
            const timerDisplay = document.getElementById('timer');
            timerDisplay.style.display = 'block';
            updateTimerDisplay();
            
            timerInterval = setInterval(() => {
                timerSeconds--;
                updateTimerDisplay();
                
                if (timerSeconds <= 30) {
                    timerDisplay.classList.add('warning');
                }
                
                if (timerSeconds <= 0) {
                    stopTimer();
                    alert('‚è∞ ¬°Tiempo terminado!');
                }
            }, 1000);
            
            document.getElementById('timerBtn').textContent = '‚èπÔ∏è Detener';
            document.getElementById('timerBtn').onclick = stopTimer;
        }

        function stopTimer() {
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
            }
            const timerDisplay = document.getElementById('timer');
            timerDisplay.style.display = 'none';
            timerDisplay.classList.remove('warning');
            document.getElementById('timerBtn').textContent = '‚è±Ô∏è Iniciar Timer';
            document.getElementById('timerBtn').onclick = startTimer;
        }

        function updateTimerDisplay() {
            const mins = Math.floor(timerSeconds / 60);
            const secs = timerSeconds % 60;
            document.getElementById('timer').textContent = 
                `${mins}:${secs.toString().padStart(2, '0')}`;
        }

        function updateCounter() {
            document.getElementById('challengeCounter').textContent = 
                `Desaf√≠o ${challengeCount} de 20`;
        }

        function updateProgress() {
            const progress = Math.min((challengeCount / 20) * 100, 100);
            document.getElementById('progressBar').style.width = progress + '%';
        }

        function skipChallenge() {
            if (confirm('¬øSeguro que quieres saltar este desaf√≠o? üòè')) {
                nextChallenge();
            }
        }

        function endGame() {
            if (confirm('¬øTerminar la sesi√≥n? El progreso se perder√°.')) {
                stopTimer();
                challengeCount = 0;
                updateCounter();
                updateProgress();
                showScreen('modeScreen');
            }
        }

        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(screenId).classList.add('active');
            
            const backBtn = document.getElementById('backBtn');
            const homeBtn = document.getElementById('homeBtn');
            
            if (screenId === 'configScreen') {
                backBtn.style.display = 'none';
                homeBtn.style.display = 'none';
            } else {
                backBtn.style.display = 'block';
                homeBtn.style.display = 'block';
            }
        }

        function goBack() {
            const currentScreen = document.querySelector('.screen.active').id;
            if (currentScreen === 'modeScreen') {
                showScreen('configScreen');
            } else if (currentScreen === 'gameScreen') {
                if (confirm('¬øVolver a selecci√≥n de modo? Se perder√° el progreso actual.')) {
                    stopTimer();
                    showScreen('modeScreen');
                }
            }
        }

        function goHome() {
            if (confirm('¬øVolver al inicio? Se perder√° el progreso actual.')) {
                stopTimer();
                challengeCount = 0;
                updateCounter();
                updateProgress();
                showScreen('configScreen');
            }
        }

        initConfig();
    </script>
</body>
</html>